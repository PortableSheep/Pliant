(function(e){e.expr[":"].plVisible||(e.expr[":"].plVisible=function(i){return"none"!=e(i).css("display")}),e.pliantPlugins||(e.pliantPlugins={}),e.fn.pliant=function(i){var s=this.options=e.extend(!0,{rules:{required:{validate:function(){return this.is("[type=checkbox],[type=radio]")?this.is(":checked"):e.trim(this.val()).length>0},message:"Required"},length:{min:0,max:256,message:"Invalid length",validate:function(e){var i=this.val().replace(/\n/g,"\r\n").length,s=!0;return s&=e.max?e.max>=i:!0,s&=e.min?i>=e.min:!0}},numeric:{validate:function(){return/^\d+$/i.test(this.val())},message:"Numeric only"}},fields:[],appendRulesToFieldClass:!1,reconcileFieldOrder:!1,haltOnFirstInvalidRule:!0,hideMessageContainerOnLoad:!0,validateOnChange:!0,focusFirstInvalidField:!1,parseMarkup:!1,ignoreHidden:!0,ignoreDisabled:!0,validateSubmit:!0,validateSubmitSelector:null,validateSubmitOn:"click",validateSubmitScope:null,inputSelector:":input[type!=button]",messageElement:"<label />",messageWrap:null,messageContainer:null,messageElementClass:"pl-element-error",messageWrapClass:"pl-wrap-error",inputClass:"pl-input-error"},i),a=e(this),n=this,t=0,l=this.fields=[],r={},d={},o=function(e,i,s){if(d[e])if(d[e]instanceof Array)for(var a in d[e])d[e][a].apply(i,s||[]);else d[e].apply(i,s||[])},u=function(e){e&&e._origMsg&&e.message[0].innerHTML!==e._origMsg&&e.message.html(e._origMsg)},f=function(){t=0;var e="."+s.messageElementClass;for(var i in l){var a=l[i];if(a.isEnabled){var n=!0;for(var r in a.rules){var d=a.rules[r];d.isEnabled===!1||s.haltOnFirstInvalidRule&&!Boolean(n)?(d.message.hide(),d.container&&d.container.toggle(d.container.find(e).filter(":plVisible").length>0)):(n&=d.isValid!==!1,d.message.toggle(d.isValid===!1),d.container&&d.container.toggle(d.container.find(e).filter(":plVisible").length>0))}(a.isValid=Boolean(n))===!1?(t++,a.field.is(":input")&&a.field.addClass(s.inputClass)):a.field.is(":input")&&a.field.removeClass(s.inputClass),a.container&&a.container.toggle(a.container.find(e).filter(":plVisible").length>0)}}s.messageContainer&&s.messageContainer.toggle(s.messageContainer.find(e).filter(":plVisible").length>0)},h=function(e,i){if(i)for(var s in i)e.hasOwnProperty(s)||"inherit"==s||(e[s]=i[s])},c=function(i,a,n){for(var t in n)this[t]=n[t];var l=s.rules[a],r=l&&l.inherit&&s.rules[l.inherit]?s.rules[l.inherit]:null;if(!(void 0!==this.message&&(void 0===this.validate||this.validate instanceof Function)||l))throw"Rule `"+a+"` is invalid.";(l||this.hasOwnProperty("message"))&&(h(this,l),h(this,r),this._origMsg=this.message,this.message=e(s.messageElement).addClass(s.messageElementClass).append(this.message),s.messageWrap&&(this.message=e(s.messageWrap).addClass(s.messageWrapClass).append(this.message)),this.message.hide(),this.container&&this.container.hide(),s.onMessagePlacement?o("onMessagePlacement",i.field,[this.message]):this.container?e(this.container).append(this.message):i.container?e(i.container).append(this.message):s.messageContainer?s.messageContainer.append(this.message):i.field.after(this.message),s.appendRulesToFieldClass&&i.field.addClass(a))},v=function(e){var i=this;this.isValid=!0,this.isEnabled=!0,this.isValidPrev=!0;for(var a in e)"rules"!==a&&(this[a]=e[a]);(e.validateOnChange||s.validateOnChange&&e.validateOnChange!==!1)&&this.field.on("change.pliant",function(){i.Validate(null,!0,!1,!0)}),this.container&&this.container.hide();var n={};for(var a in e.rules)n[a]=new c(this,a,e.rules[a]);this.rules=n,o("onFieldAdded",this.field,[this])},g=function(e){if(e instanceof Array)for(var i in e)g(e[i]);else if(void 0!==e.field&&e.field.attr("id"))if(s.reconcileFieldOrder){var n=a.find(s.inputSelector).index(e.field);l.splice(n>-1?n:l.length,0,new v(e))}else l.push(new v(e))},p=function(i){i=i instanceof v||void 0!==i.field?i:{field:i},i.field instanceof String&&(i.field=e(i.field));for(var s in l)if(l[s].field.get(0)==i.field.get(0)||l[s].field.attr("id")&&l[s].field.attr("id")==i.field.attr("id"))return s;return-1},m=(this.RemoveField=function(e){var i=p(e);if(i>-1){for(var a in l[i].rules)l[i].rules[a].message.remove(),s.appendRulesToFieldClass&&l[i].field.removeClass(a);o("onFieldRemoved",l[i],[this]),l.splice(i,1)}},this.SetFieldEnabled=function(e,i){var s=p(e);s>-1&&(l[s].isEnabled=i,o("onFieldToggle",l[s],[i,this]))},this.SetFieldRuleEnabled=function(e,i,a){var n=p(e);if(n>-1)for(var t in l[n].rules)if(t==i){l[n].rules[t].isEnabled=a,s.appendRulesToFieldClass&&l[n].field.toggleClass(t,a),o("onFieldRuleToggle",l[n],[a,t,this]);break}},this.ValidateRule=function(e,i){return s.rules[e]?s.rules[e].validate(i):!1},this.ResetState=function(e){if(void 0===e)for(var i in l){l[i].isValid=!0;for(var s in l[i].rules)l[i].rules[s].isValid=!0}else{var a=p(e);if(a>-1){l[a].isValid=!0;for(var n in l[a].rules)l[a].rules[n].isValid=!0}}f()},this.SetState=function(e){if(e instanceof Array)for(var i in e)m(e[i]);else{var s=p(e.field);if(s>-1){for(var a in e.rules)l[s].rules[a]&&(l[s].rules[a].isValid=e.rules[a]);f()}}}),C=function(e){var i=[];if(8===e.nodeType&&/^\s*{.*}\s*$/.test(e.nodeValue))i.splice(0,0,e.nodeValue);else if(e.childNodes.length>0)for(var s=0;e.childNodes.length>s;s++)i=i.concat(C(e.childNodes[s]));return i},b=this.AddMarkupRules=function(i){var s=i||a,t=(e(this),C(s[0]));for(var l in t){var r=e.parseJSON(t[l]);r&&r instanceof Object&&r.hasOwnProperty("field")&&r.hasOwnProperty("rules")&&(r.field=e(r.field),n.AddField(r))}},F=this.ValidateField=function(e){if(!(e instanceof Array)){var i=-1,s=null;if(e instanceof Object&&"string"!=typeof e&&!(e instanceof jQuery)&&e.field&&e.rules&&(e.rules instanceof Array||"string"==typeof e.rules)?(i=p(e.field),s=e.rule?[e.rule]:e.rules):i=p(e),-1==i)throw"Field `"+e.selector+"` cannot be found.";return l[i].Validate(null,!0,!0,!1,s)}for(var a in e)F(e[a])};if(c.prototype.SetMessage=function(e){e.length>0&&this.message.html(e)},v.prototype.Validate=function(i,a,t,l,r){if(this.isValidPrev=this.isValid,this.isValid=!0,!(!this.isEnabled||this.field.is(":disabled")&&s.ignoreDisabled||this.field.is(":hidden")&&s.ignoreHidden||l&&this.validateOnChange instanceof Function&&this.validateOnChange.call(this.field,this)===!1)){o("onPreFieldValidate",n,[this]);for(var d in this.rules)if(!(r&&r.length>0&&-1===r.indexOf(d))){var h=this.rules[d];if(h.isEnabled!==!1){if(void 0!==h.validateOnChange&&h.validateOnChange!==!0&&l&&(h.validateOnChange instanceof Function&&h.validateOnChange.call(this.field,this)===!1||h.validateOnChange===!1)){h.isValid=!0;continue}if(s.haltOnFirstInvalidRule&&!this.isValid)break;u(h);var c=i?e.merge([h],i):[h],v=h.validate?h.validate.apply(this.field,c):!0;this.isValid&=h.isValid=h.expectedResult?v===h.expectedResult:Boolean(v)}}a&&f(),o("onPostFieldValidate",n,[this,this.isValid]),s.validateOnChange&&o("onFieldValidate",n,[this,this.isValid]),this.chain&&!t&&l&&F(this.chain)}return this.isValid},this.Destroy=function(){this.ResetState(),this.ClearFields(),d=[]},this.Subscribe=function(e,i){return d[e]?d[e].push(i):d[e]=[i],this},this.AddField=function(e){if(e){if(e instanceof Array)for(var i in e)this.AddField(e[i]);else{var i=p(e);if(i>-1&&void 0!==e.rules)for(var s in e.rules)l[i].rules[s]?(l[i].rules[s].message.remove(),l[i].rules[s]=new c(l[i],s,e.rules[s])):l[i].rules[s]=new c(e,s,e.rules[s]);else-1==i&&g(e)}f()}},this.GetInvalidCount=function(){return t},this.TotalFields=function(){return l.length},this.ClearFields=function(){for(var e in l)for(var i in l[e].rules)l[e].rules[i].message.remove(),s.appendRulesToFieldClass&&l[e].field.removeClass(i),l[e].field.off(".pliant");l=[],t=0,f()},this.Validate=function(){var e=!0,i=!1;for(var a in l)e&=l[a].Validate(arguments,!1,!1,!1),!s.focusFirstInvalidField||e||i||(o("onInvalidFieldFocus",l[a].field),l[a].field.focus(),i=!0);return f(),e=Boolean(e),o("onFormValidate",this,[l,e]),e},s.validateSubmit){var V=function(e){n.Validate()||e.preventDefault()};if(s.validateSubmitSelector){var S=a;s.validateSubmitScope&&(S=s.validateSubmitScope instanceof jQuery?s.validateSubmitScope:e(s.validateSubmitScope)),S.on(s.validateSubmitOn||"click",s.validateSubmitSelector instanceof jQuery?s.validateSubmitSelector.selector:s.validateSubmitSelector,V)}else a.is("form")&&a.submit(V)}for(var y in s.rules)if((void 0===s.rules[y].message||void 0!==s.rules[y].validate&&!(s.rules[y].validate instanceof Function))&&void 0===s.rules[y].inherit)throw"Rule `"+y+"` is invalid.";s.hideMessageContainerOnLoad&&s.messageContainer&&s.messageContainer.hide();for(var O in s)"on"==O.slice(0,2)&&(s[O]instanceof Function||s[O]instanceof Array)&&this.Subscribe(O,s[O]);if(e.pliantPlugins&&s.plugins)for(var R in s.plugins)e.pliantPlugins.hasOwnProperty(R)&&(r[R]=new e.pliantPlugins[R](s.plugins[R],this));return this.AddField(s.fields),f(),s.parseMarkup&&b(),o("onLoadComplete",[this]),this}})(jQuery);